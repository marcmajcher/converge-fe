(this["webpackJsonpconverge-fe"]=this["webpackJsonpconverge-fe"]||[]).push([[0],{108:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(11),c=t.n(o);t(55);function u(e){return{type:"SET_GAME_STATE",payload:e}}function l(e){return{type:"SET_WORDS",payload:e}}var i=t(48),d=t.n(i),m=t(1);t(91);function s(){var e=Object(m.d)((function(e){return e.countdown}));return r.a.createElement("div",null,r.a.createElement("h1",null,"COUNTDOWN"),r.a.createElement("h2",null,"Game starts in: ",e))}var f=t(5),E=["endGame","joinGame","sendWord","startNewGame","resetGame"];function O(e){var n=Object(m.d)((function(e){return e.socket}));if(n){if(E.includes(e))return function(t){n.emit(e,t)};throw new Error("Invalid socket message type: ".concat(e))}}function v(){var e=Object(a.useState)(""),n=Object(f.a)(e,2),t=n[0],o=n[1],c=Object(a.useState)(!1),u=Object(f.a)(c,2),l=u[0],i=u[1],d=O("sendWord"),s=Object(m.d)((function(e){return e.words})),E=Object(m.d)((function(e){return e.socket}));Object(a.useEffect)((function(){i(!1),o("")}),[s]);var v=E.id,g=s?s[s.length-1]:{},p=s?Object.keys(g).filter((function(e){return e!==v}))[0]:null;return r.a.createElement("div",null,r.a.createElement("h1",null,"GAME ON"),s&&s.length>0?r.a.createElement("div",null,r.a.createElement("div",null,"Your Last Word: ",g[v]),r.a.createElement("div",null,"Their Last Word:",g[p])):"",l?r.a.createElement("div",null,"You sent: ",t," -- waiting..."):r.a.createElement("div",null,"Enter a word:"," ",r.a.createElement("input",{value:t,onChange:function(e){return o(e.target.value)}}),r.a.createElement("button",{onClick:function(){d(t),i(!0)}},"GO!")))}function g(){var e=O("joinGame"),n=Object(a.useState)(""),t=Object(f.a)(n,2),o=t[0],c=t[1];return r.a.createElement("div",null,r.a.createElement("h1",null,"JOIN GAME"),"Game ID:"," ",r.a.createElement("input",{value:o,onChange:function(e){return c(e.target.value)}}),r.a.createElement("button",{onClick:function(){return e(o)}},"Begin!"))}function p(){return r.a.createElement("div",null,r.a.createElement("h1",null,"LOG IN -----\x3e over there"))}function b(e){var n=e.userInfo;return r.a.createElement("div",null,r.a.createElement("h1",null,"Hi, ",n.givenName,"!"))}function j(){var e=Object(m.d)((function(e){return e.userInfo}));return r.a.createElement(b,{userInfo:e})}function G(){var e=Object(m.c)();return r.a.createElement("div",null,r.a.createElement(j,null),r.a.createElement("button",{onClick:function(){return e(u("newGame"))}},"Start a New Game"),r.a.createElement("button",{onClick:function(){return e(u("joinGame"))}},"Join a Game"))}var I=t(22),h=t(23),S=t.n(h);function k(){var e=Object(m.c)(),n=Object(m.d)((function(e){return e.appId})),t=Object(m.d)((function(e){return e.endpoint})),o=Object(m.d)((function(e){return e.loggedIn})),c=Object(m.d)((function(e){return e.token}));return Object(a.useEffect)((function(){c&&S.a.post("".concat(t,"/users/verify"),{token:c}).then((function(n){return e({type:"SET_USER_INFO",payload:n.data})})).catch((function(){return e({type:"LOG_OUT",payload:!1})}))}),[c]),r.a.createElement(r.a.Fragment,null,r.a.createElement(I.GoogleLogout,{className:o?"":"hidden",clientId:n,buttonText:"Logout",onLogoutSuccess:function(){return e({type:"LOG_OUT",payload:!1})}}),r.a.createElement(I.GoogleLogin,{clientId:n,className:o?"hidden":"",buttonText:"Log In With Google",onSuccess:function(n){return a=n,void S.a.post("".concat(t,"/users"),{token:a.tokenObj.id_token,userData:a.profileObj}).then((function(n){return e(function(e,n){return{type:"LOG_IN",payload:{token:n,userInfo:e}}}(a.profileObj,n.data.token))})).catch((function(e){return console.error(e)}));var a},onFailure:function(e){return console.error("Login Error: ".concat(e))},cookiePolicy:"single_host_origin"}))}var y=Object(m.b)((function(e){return e}))((function(e){return r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"home-menu pure-menu pure-menu-horizontal pure-menu-fixed"},r.a.createElement("a",{className:"pure-menu-heading",href:"/"},"Converge"),r.a.createElement("ul",{className:"pure-menu-list"},e.userInfo&&r.a.createElement("li",{className:"pure-menu-item"},r.a.createElement("img",{className:"user-image",src:e.userInfo.imageUrl,alt:e.userInfo.name})),r.a.createElement("li",{className:"pure-menu-item"},r.a.createElement(k,null)))))}));function _(){var e=O("startNewGame"),n=Object(m.d)((function(e){return e.gameId}));return Object(a.useEffect)((function(){return e()}),[]),n?r.a.createElement("div",null,"Your game id is:",r.a.createElement("h1",null,n)):r.a.createElement("h1",null,"Starting...")}function T(){var e=Object(m.d)((function(e){return e.socket})),n=Object(m.d)((function(e){return e.words})),t=O("resetGame"),a=O("endGame"),o=e.id,c=n?Object.keys(n[0]).filter((function(e){return e!==o}))[0]:null;return r.a.createElement("div",null,r.a.createElement("h1",null,"YOU WIN!"),r.a.createElement("div",null,"Your Words / Their Words:",r.a.createElement("ul",null,n&&n.map((function(e,n){return r.a.createElement("li",{key:n},e[o]," / ",e[c])})))),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return t()}},"Play Again")," ",r.a.createElement("button",{onClick:function(){a()}},"Back to Main")))}var N=t(2),w=t(12),C={appId:"730966416306-dv0e9pb4m0k6khl2nrn5r9vskv2j8hmk.apps.googleusercontent.com",countdown:void 0,endpoint:"https://converge-game-be.herokuapp.com",gameId:void 0,gameState:void 0,loggedIn:!1,socket:void 0,token:void 0,userInfo:void 0,words:void 0};var A=Object(w.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"CHECK_TOKEN":var t=localStorage.getItem("_t");return Object(N.a)({},e,{token:t});case"CLEAR_GAME":return Object(N.a)({},e,{gameState:"main",gameId:void 0,words:void 0,countdown:void 0});case"LOG_IN":var a=n.payload,r=a.token,o=a.userInfo;return localStorage.setItem("_t",r),Object(N.a)({},e,{userInfo:o,token:r,loggedIn:!0});case"LOG_OUT":return localStorage.setItem("_t",""),e.socket&&e.socket.disconnect(!0),Object(N.a)({},e,{loggedIn:!1,token:void 0,userInfo:void 0});case"RESET_COUNTDOWN":return Object(N.a)({},e,{countdown:void 0});case"RESET_GAME":return Object(N.a)({},e,{countdown:void 0,words:void 0});case"RESET_WORDS":return Object(N.a)({},e,{words:void 0});case"SET_COUNTDOWN":return Object(N.a)({},e,{countdown:n.payload});case"SET_GAME_ID":return Object(N.a)({},e,{gameId:n.payload});case"SET_GAME_STATE":return Object(N.a)({},e,{gameState:n.payload});case"SET_SOCKET":return Object(N.a)({},e,{socket:n.payload});case"SET_USER_INFO":return Object(N.a)({},e,{userInfo:n.payload,loggedIn:!0});case"SET_WORDS":return Object(N.a)({},e,{words:n.payload});default:return e}}),C);c.a.render(r.a.createElement(m.a,{store:A},r.a.createElement((function(){var e=Object(m.d)((function(e){return e.endpoint})),n=Object(m.d)((function(e){return e.gameState})),t=!!Object(m.d)((function(e){return e.userInfo})),o=Object(m.d)((function(e){return e.token})),c=Object(m.c)(),i=function(){var e=Object(m.c)();return function(n){n.on("endGame",(function(){return e({type:"CLEAR_GAME"})})),n.on("info",(function(e){return console.info("INFO: ".concat(e))})),n.on("newGameCreated",(function(n){return e({type:"SET_GAME_ID",payload:n.gameId})})),n.on("resetGame",(function(){return e({type:"RESET_GAME"})})),n.on("roundOver",(function(n){return e(l(n))})),n.on("startCountdown",(function(n){e(function(e){return{type:"SET_COUNTDOWN",payload:e}}(n)),n>=0&&e(u("countdown"))})),n.on("startGame",(function(){return e(u("game"))})),n.on("winGame",(function(n){e(u("winGame")),e(l(n))})),e(function(e){return{type:"SET_SOCKET",payload:e}}(n))}}(),f={countdown:r.a.createElement(s,null),game:r.a.createElement(v,null),joinGame:r.a.createElement(g,null),main:r.a.createElement(G,null),newGame:r.a.createElement(_,null),winGame:r.a.createElement(T,null)};Object(a.useEffect)((function(){if(c({type:"CHECK_TOKEN"}),o){var n=d.a.connect(e,{query:"token=".concat(o)});n.on("connect",(function(){i(n),c({type:"CLEAR_GAME"}),c(u("main"))})).on("unauthorized",(function(e){console.log("unauthorized: ".concat(JSON.stringify(e.data)))}))}}),[o]);var E=t?f[n]:r.a.createElement(p,null);return console.log("GAME STATE",n),r.a.createElement(r.a.Fragment,null,r.a.createElement(y,null),r.a.createElement("div",{className:"content"},E))}),{className:"app"})),document.getElementById("root"))},50:function(e,n,t){e.exports=t(108)},55:function(e,n,t){},83:function(e,n){},91:function(e,n,t){}},[[50,1,2]]]);
//# sourceMappingURL=main.4a1a73d1.chunk.js.map