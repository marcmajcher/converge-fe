(this["webpackJsonpconverge-fe"]=this["webpackJsonpconverge-fe"]||[]).push([[0],{121:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(20),c=n.n(o),u=(n(68),n(58)),l=(n(69),n(59)),i=n.n(l);var m=n(1);var d=n(8),s=n(10),f=n(30),E=n(31),p=n.n(E);function O(){var e=Object(m.c)(),t=Object(m.d)((function(e){return e.appId})),n=Object(m.d)((function(e){return e.endpoint})),o=Object(m.d)((function(e){return e.loggedIn})),c=Object(m.d)((function(e){return e.token}));return Object(a.useEffect)((function(){c&&p.a.post("".concat(n,"/users/verify"),{token:c}).then((function(t){return e({type:"SET_USER_INFO",payload:t.data})})).catch((function(){return e({type:"LOG_OUT",payload:!1})}))}),[c]),r.a.createElement(r.a.Fragment,null,r.a.createElement(f.GoogleLogout,{className:o?"":"hidden",clientId:t,buttonText:"Logout",onLogoutSuccess:function(){return e({type:"LOG_OUT",payload:!1})}}),r.a.createElement(f.GoogleLogin,{clientId:t,className:o?"hidden":"",buttonText:"Log In With Google",onSuccess:function(t){return a=t,void p.a.post("".concat(n,"/users"),{token:a.tokenObj.id_token,userData:a.profileObj}).then((function(t){return e(function(e,t){return{type:"LOG_IN",payload:{token:t,userInfo:e}}}(a.profileObj,t.data.token))})).catch((function(e){return console.error(e)}));var a},onFailure:function(e){return console.error("Login Error: ".concat(e))},cookiePolicy:"single_host_origin"}))}var g=Object(m.b)((function(e){return e}))((function(e){return r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"home-menu pure-menu pure-menu-horizontal pure-menu-fixed"},r.a.createElement("a",{className:"pure-menu-heading",href:"/"},"Converge"),r.a.createElement("ul",{className:"pure-menu-list"},e.userInfo&&r.a.createElement("li",{className:"pure-menu-item"},r.a.createElement("img",{className:"user-image",src:e.userInfo.imageUrl,alt:e.userInfo.name})),r.a.createElement("li",{className:"pure-menu-item"},r.a.createElement(O,{loggedIn:e.userInfo})))))}));function v(){var e=Object(m.d)((function(e){return e.countdown}));return e>0?r.a.createElement("div",null,r.a.createElement("h1",null,"COUNTDOWN"),r.a.createElement("h2",null,"Game starts in: ",e)):r.a.createElement(s.a,{to:"/game"})}function b(){return r.a.createElement("h1",null,"GAME ON")}var h=n(62),I=["joinGame","startNewGame"];function j(e){var t=Object(m.d)((function(e){return e.socket}));if(t){if(I.includes(e))return function(n){t.emit(e,n)};throw new Error("Invalid socket message type: ".concat(e))}}function N(){var e=Object(a.useState)(""),t=Object(h.a)(e,2),n=t[0],o=t[1],c=j("joinGame");return Object(m.d)((function(e){return e.countdown}))?r.a.createElement(s.a,{to:"/cd"}):r.a.createElement("div",null,r.a.createElement("h1",null,"JOIN GAME"),"Game ID: ",r.a.createElement("input",{value:n,onChange:function(e){o(e.target.value)}}),r.a.createElement("button",{onClick:function(){c(n)}},"Begin!"))}function k(){var e=Object(m.d)((function(e){return e.loggedIn})),t=Object(m.d)((function(e){return e.endpoint}));return e?r.a.createElement(s.a,{to:"/"}):r.a.createElement("div",null,r.a.createElement("h1",null,"LOG IN -----\x3e over there"),r.a.createElement("h2",null,"ENV: ","production"),r.a.createElement("h2",null,"URL: ",t))}function y(e){var t=e.userInfo;return r.a.createElement("div",null,r.a.createElement("h1",null,"Hi, ",t.givenName,"!"))}function _(){var e=Object(m.d)((function(e){return e.userInfo}));return r.a.createElement(y,{userInfo:e})}function G(){return r.a.createElement("div",null,r.a.createElement(_,null),r.a.createElement(d.b,{to:"/new"},"Start a New Game"),"or",r.a.createElement(d.b,{to:"/join"},"Join a Game"))}function S(){var e=j("startNewGame"),t=Object(m.d)((function(e){return e.gameId})),n=Object(m.d)((function(e){return e.countdown}));return Object(a.useEffect)((function(){return e()}),[]),n?r.a.createElement(s.a,{to:"/cd"}):t?r.a.createElement("div",null,"Your game id is:",r.a.createElement("h1",null,t)):r.a.createElement("h1",null,"Starting...")}function T(e){var t=e.children,n=Object(u.a)(e,["children"]),a=!!Object(m.d)((function(e){return e.userInfo}));return r.a.createElement(s.b,Object.assign({},n,{render:function(e){var n=e.location;return a?t:r.a.createElement(s.a,{to:{pathname:"/login",state:{from:n}}})}}))}var w=n(9),C=n(22),L={appId:"730966416306-dv0e9pb4m0k6khl2nrn5r9vskv2j8hmk.apps.googleusercontent.com",countdown:void 0,endpoint:"https://converge-game-be.herokuapp.com/",gameId:void 0,loggedIn:!1,socket:void 0,token:void 0,userInfo:void 0};var x=Object(C.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHECK_TOKEN":var n=localStorage.getItem("_t");return Object(w.a)({},e,{token:n});case"SET_USER_INFO":return Object(w.a)({},e,{userInfo:t.payload,loggedIn:!0});case"SET_SOCKET":return Object(w.a)({},e,{socket:t.payload});case"LOG_IN":var a=t.payload,r=a.token,o=a.userInfo;return localStorage.setItem("_t",r),Object(w.a)({},e,{userInfo:o,token:r,loggedIn:!0});case"LOG_OUT":return localStorage.setItem("_t",""),e.socket.disconnect(!0),Object(w.a)({},e,{loggedIn:!1,token:void 0,userInfo:void 0});case"SET_GAME_ID":return Object(w.a)({},e,{gameId:t.payload});case"SET_COUNTDOWN":return Object(w.a)({},e,{countdown:t.payload});case"CLEAR_COUNTDOWN":return Object(w.a)({},e,{countdown:void 0});default:return e}}),L);c.a.render(r.a.createElement(m.a,{store:x},r.a.createElement((function(){var e=Object(m.d)((function(e){return e.endpoint})),t=Object(m.c)(),n=Object(m.d)((function(e){return e.token})),o=function(){var e=Object(m.c)();return function(t){t.on("info",(function(e){return console.info("INFO: ".concat(e))})),t.on("newGameCreated",(function(t){return e({type:"SET_GAME_ID",payload:t.gameId})})),t.on("startCountdown",(function(t){return e(function(e){return{type:"SET_COUNTDOWN",payload:e}}(t))})),t.on("startGame",(function(e){return console.log(e)})),e(function(e){return{type:"SET_SOCKET",payload:e}}(t))}}();return Object(a.useEffect)((function(){if(t({type:"CHECK_TOKEN"}),n){var a=i.a.connect(e,{query:"token=".concat(n)});a.on("connect",(function(){o(a)})).on("unauthorized",(function(e){throw console.log("unauthorized: ".concat(JSON.stringify(e.data))),new Error(e.data.type)}))}}),[n]),r.a.createElement(d.a,null,r.a.createElement(g,null),r.a.createElement("div",{className:"content"},r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/login"},r.a.createElement(k,null)),r.a.createElement(T,{exact:!0,path:"/"},r.a.createElement(G,null)),r.a.createElement(T,{exact:!0,path:"/new"},r.a.createElement(S,null)),r.a.createElement(T,{exact:!0,path:"/join"},r.a.createElement(N,null)),r.a.createElement(T,{exact:!0,path:"/cd"},r.a.createElement(v,null)),r.a.createElement(T,{exact:!0,path:"/game"},r.a.createElement(b,null)))))}),{className:"app"})),document.getElementById("root")),console.log("ENV: ".concat("production"))},63:function(e,t,n){e.exports=n(121)},68:function(e,t,n){},69:function(e,t,n){},97:function(e,t){}},[[63,1,2]]]);
//# sourceMappingURL=main.3e275020.chunk.js.map