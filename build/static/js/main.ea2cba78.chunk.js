(this["webpackJsonpconverge-fe"]=this["webpackJsonpconverge-fe"]||[]).push([[0],{106:function(e,t,n){},107:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(11),c=n.n(o);function u(e){return{type:"SET_GAME_STATE",payload:e}}function l(e){return{type:"SET_WORDS",payload:e}}var i=n(48),m=n.n(i),s=n(1);function d(){var e=Object(s.d)((function(e){return e.countdown}));return r.a.createElement("div",null,r.a.createElement("h1",null,e),r.a.createElement("h2",null,"Game Begins In..."))}var E=n(5),f=["endGame","joinGame","sendWord","startNewGame","resetGame"];function v(e){var t=Object(s.d)((function(e){return e.socket}));if(t){if(f.includes(e))return function(n){t.emit(e,n)};throw new Error("Invalid socket message type: ".concat(e))}}function g(){var e=Object(a.useState)(""),t=Object(E.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),u=Object(E.a)(c,2),l=u[0],i=u[1],m=v("sendWord"),d=Object(s.d)((function(e){return e.words})),f=Object(s.d)((function(e){return e.socket}));function g(){m(n),i(!0)}Object(a.useEffect)((function(){i(!1),o("")}),[d]);var b=f.id,O=d?d[d.length-1]:{},p=d?Object.keys(O).filter((function(e){return e!==b}))[0]:null;return r.a.createElement("div",null,d&&d.length>0?r.a.createElement("div",null,r.a.createElement("div",{className:"your word"},r.a.createElement("h2",null,"Your Last Word:"),r.a.createElement("div",{className:"word-sent"},O[b])),r.a.createElement("div",{className:"their word"},r.a.createElement("h2",null,"Their Last Word:"),r.a.createElement("div",{className:"word-sent"},O[p]))):"",l?r.a.createElement("div",null,r.a.createElement("h1",{className:d?"you-sent":""},"You sent: "),r.a.createElement("p",{className:"word-sent word-submitted"},n),r.a.createElement("h2",null,"Waiting for other player...")):r.a.createElement("div",null,r.a.createElement("h1",{className:"clear"},"Enter a word:"),r.a.createElement("div",null,r.a.createElement("input",{autoFocus:!0,type:"text",value:n,onChange:function(e){return o(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&g()}})),r.a.createElement("button",{className:"pure-button button-main",onClick:g},"GO!")))}function b(){var e=v("joinGame"),t=Object(a.useState)(""),n=Object(E.a)(t,2),o=n[0],c=n[1];return Object(a.useEffect)((function(){}),[]),r.a.createElement("div",null,r.a.createElement("h1",null,"Enter code to join game:"),r.a.createElement("div",null,r.a.createElement("input",{autoFocus:!0,type:"text",onChange:function(e){return c(e.target.value)},onKeyPress:function(t){"Enter"===t.key&&e(o)},placeholder:"Enter code here",value:o})),r.a.createElement("button",{className:"pure-button button-main",onClick:function(){return e(o)}},"Begin!"))}function O(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Log in with your Google account",r.a.createElement("br",null),"to begin playing!"))}function p(){var e=Object(s.c)(),t=Object(s.d)((function(e){return e.userInfo}));return r.a.createElement("div",null,r.a.createElement("h1",null,"Hi, ",t.givenName,"!"),r.a.createElement("h2",null,"Would you like to:"),r.a.createElement("button",{className:"pure-button button-main",onClick:function(){return e(u("newGame"))}},"Start a New Game"),r.a.createElement("h2",null,"or"),r.a.createElement("button",{className:"pure-button button-main",onClick:function(){return e(u("joinGame"))}},"Join a Game"))}var j=n(22),h=n(23),y=n.n(h);function k(){var e=Object(s.c)(),t=Object(s.d)((function(e){return e.appId})),n=Object(s.d)((function(e){return e.endpoint})),o=Object(s.d)((function(e){return e.loggedIn})),c=Object(s.d)((function(e){return e.token}));return Object(a.useEffect)((function(){c&&y.a.post("".concat(n,"/users/verify"),{token:c}).then((function(t){return e({type:"SET_USER_INFO",payload:t.data})})).catch((function(){return e({type:"LOG_OUT",payload:!1})}))}),[c]),r.a.createElement("div",{className:o?"button-login":"splash-button-login"},r.a.createElement(j.GoogleLogout,{className:o?"":"hidden",clientId:t,buttonText:"Logout",onLogoutSuccess:function(){return e({type:"LOG_OUT",payload:!1})}}),r.a.createElement(j.GoogleLogin,{clientId:t,className:o?"hidden":"",buttonText:"Log In With Google",onSuccess:function(t){return a=t,void y.a.post("".concat(n,"/users"),{token:a.tokenObj.id_token,userData:a.profileObj}).then((function(t){return e(function(e,t){return{type:"LOG_IN",payload:{token:t,userInfo:e}}}(a.profileObj,t.data.token))})).catch((function(e){return console.error(e)}));var a},onFailure:function(e){return console.error("Login Error: ".concat(e))},cookiePolicy:"single_host_origin"}))}var w=Object(s.b)((function(e){return e}))((function(e){return r.a.createElement("header",{className:"pure-menu pure-menu-horizontal"},r.a.createElement("h1",null,"Converge"),e.userInfo&&r.a.createElement(r.a.Fragment,null,r.a.createElement("img",{className:"user-image",src:e.userInfo.imageUrl,alt:e.userInfo.name})),r.a.createElement(k,null))}));function N(){var e=v("startNewGame"),t=Object(s.d)((function(e){return e.gameId}));return Object(a.useEffect)((function(){return e()}),[]),r.a.createElement("div",null,t?r.a.createElement(r.a.Fragment,null," ",r.a.createElement("h1",null,"Your Game ID:"),r.a.createElement("div",{className:"game-id"},t),r.a.createElement("p",null,"Give this to a friend to join your game!")):r.a.createElement("h1",null,"Starting game..."))}function G(){var e=Object(s.d)((function(e){return e.socket})),t=Object(s.d)((function(e){return e.words})),n=v("resetGame"),a=v("endGame"),o=e.id,c=t?Object.keys(t[0]).filter((function(e){return e!==o}))[0]:null;return r.a.createElement("div",null,r.a.createElement("h2",null,"HECK YEAH!"),r.a.createElement("h1",null,"You Converged On:"),r.a.createElement("p",{className:"converge-word"},t&&t[t.length-1][o]),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("div",{className:"your words"},r.a.createElement("h2",null,"Your Words:"),t&&t.map((function(e,t){return r.a.createElement("div",{key:t,className:"word-sent"},e[o])}))),r.a.createElement("div",{className:"their words"},r.a.createElement("h2",null,"Their Words:"),t&&t.map((function(e,t){return r.a.createElement("div",{key:t,className:"word-sent"},e[c])}))))),r.a.createElement("p",{className:"clear"},"Again?"),r.a.createElement("div",null,r.a.createElement("button",{className:"pure-button button-main",onClick:function(){n()}},"Play Again")," "),r.a.createElement("div",null,r.a.createElement("button",{className:"pure-button button-main",onClick:function(){a()}},"Back to Main")))}var S=n(2),I=n(12),_={appId:"730966416306-dv0e9pb4m0k6khl2nrn5r9vskv2j8hmk.apps.googleusercontent.com",countdown:void 0,endpoint:"https://converge-game-be.herokuapp.com",gameId:void 0,gameState:void 0,loggedIn:!1,socket:void 0,token:void 0,userInfo:void 0,words:void 0};var T=Object(I.b)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHECK_TOKEN":var n=localStorage.getItem("_t");return Object(S.a)({},e,{token:n});case"CLEAR_GAME":return Object(S.a)({},e,{gameState:"main",gameId:void 0,words:void 0,countdown:void 0});case"LOG_IN":var a=t.payload,r=a.token,o=a.userInfo;return localStorage.setItem("_t",r),Object(S.a)({},e,{userInfo:o,token:r,loggedIn:!0});case"LOG_OUT":return localStorage.setItem("_t",""),e.socket&&e.socket.disconnect(!0),Object(S.a)({},e,{loggedIn:!1,token:void 0,userInfo:void 0});case"RESET_COUNTDOWN":return Object(S.a)({},e,{countdown:void 0});case"RESET_GAME":return Object(S.a)({},e,{gameState:"countdown",countdown:void 0,words:void 0});case"RESET_WORDS":return Object(S.a)({},e,{words:void 0});case"SET_COUNTDOWN":return Object(S.a)({},e,{countdown:t.payload});case"SET_GAME_ID":return Object(S.a)({},e,{gameId:t.payload});case"SET_GAME_STATE":return Object(S.a)({},e,{gameState:t.payload});case"SET_SOCKET":return Object(S.a)({},e,{socket:t.payload});case"SET_USER_INFO":return Object(S.a)({},e,{userInfo:t.payload,loggedIn:!0});case"SET_WORDS":return Object(S.a)({},e,{words:t.payload});default:return e}}),_);n(106);c.a.render(r.a.createElement(s.a,{store:T},r.a.createElement((function(){var e=Object(s.d)((function(e){return e.endpoint})),t=Object(s.d)((function(e){return e.gameState})),n=!!Object(s.d)((function(e){return e.userInfo})),o=Object(s.d)((function(e){return e.token})),c=Object(s.c)(),i=function(){var e=Object(s.c)();return function(t){t.on("endGame",(function(){return e({type:"CLEAR_GAME"})})),t.on("info",(function(e){return console.info("INFO: ".concat(e))})),t.on("newGameCreated",(function(t){return e({type:"SET_GAME_ID",payload:t.gameId})})),t.on("resetGame",(function(){return e({type:"RESET_GAME"})})),t.on("roundOver",(function(t){return e(l(t))})),t.on("startCountdown",(function(t){e(function(e){return{type:"SET_COUNTDOWN",payload:e}}(t)),t>=0&&e(u("countdown"))})),t.on("startGame",(function(){return e(u("game"))})),t.on("winGame",(function(t){e(u("winGame")),e(l(t))})),e(function(e){return{type:"SET_SOCKET",payload:e}}(t))}}(),E={countdown:r.a.createElement(d,null),game:r.a.createElement(g,null),joinGame:r.a.createElement(b,null),main:r.a.createElement(p,null),newGame:r.a.createElement(N,null),winGame:r.a.createElement(G,null)};Object(a.useEffect)((function(){if(c({type:"CHECK_TOKEN"}),o){var t=m.a.connect(e,{query:"token=".concat(o)});t.on("connect",(function(){i(t),c({type:"CLEAR_GAME"}),c(u("main"))})).on("unauthorized",(function(e){console.log("unauthorized: ".concat(JSON.stringify(e.data)))}))}}),[o]);var f=n?E[t]:r.a.createElement(O,null);return r.a.createElement(r.a.Fragment,null,r.a.createElement(w,null),r.a.createElement("div",{className:"page-".concat(t||"login")},f))}),null)),document.getElementById("root"))},50:function(e,t,n){e.exports=n(107)},82:function(e,t){}},[[50,1,2]]]);
//# sourceMappingURL=main.ea2cba78.chunk.js.map