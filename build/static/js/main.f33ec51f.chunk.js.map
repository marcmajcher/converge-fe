{"version":3,"sources":["components/loginButton.js","actions.js","components/navBar.js","components/pages/countdownPage.js","hooks/useEmitter.js","components/pages/gamePage.js","components/pages/joinGamePage.js","components/pages/loginPage.js","components/userInfo.js","components/pages/userPage.js","components/pages/mainPage.js","components/pages/startGamePage.js","App.js","redux-store.js","index.js","hooks/useSocketSetup.js"],"names":["LoginButton","dispatch","useDispatch","appId","useSelector","s","endpoint","loggedIn","token","useEffect","axios","post","then","response","type","payload","data","catch","className","clientId","buttonText","onLogoutSuccess","onSuccess","res","info","tokenObj","id_token","userData","profileObj","userInfo","logInUser","err","console","error","onFailure","cookiePolicy","connect","store","props","href","src","imageUrl","alt","name","CountdownPage","count","countdown","to","validMessages","useEmitter","socket","includes","emit","Error","GamePage","useState","word","setWord","submitted","setSubmitted","emitSendWord","words","log","roundWords","length","myId","id","theirId","Object","keys","filter","e","value","onChange","target","onClick","JoinGamePage","gameId","setGameId","emitJoinGame","LoginPage","UserInfo","givenName","UserPage","MainPage","StartGamePage","emitStartGame","AuthRoute","children","rest","render","location","pathname","state","from","defaultStore","undefined","createStore","action","localToken","localStorage","getItem","setItem","disconnect","ReactDOM","initSocket","on","message","setCountdown","msg","setWords","setSocket","useSocketSetup","io","query","JSON","stringify","exact","path","document","getElementById","process"],"mappings":"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","file":"static/js/main.f33ec51f.chunk.js","sourcesContent":["import { GoogleLogin, GoogleLogout } from 'react-google-login';\nimport React, { useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport axios from 'axios';\nimport { logInUser, logOutUser, setUserInfo } from '../actions';\n\nexport default function LoginButton() {\n  const dispatch = useDispatch();\n  const appId = useSelector(s => s.appId);\n  const endpoint = useSelector(s => s.endpoint);\n  const loggedIn = useSelector(s => s.loggedIn);\n  const token = useSelector(s => s.token);\n\n  useEffect(() => {\n    if (token) {\n      axios\n        .post(`${endpoint}/users/verify`, { token })\n        .then(response => dispatch(setUserInfo(response.data)))\n        .catch(() => dispatch(logOutUser()));\n    } \n  }, [token]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  function handleLogin(info) {\n    axios\n      .post(`${endpoint}/users`, {\n        token: info.tokenObj.id_token,\n        userData: info.profileObj,\n      })\n      .then(res => dispatch(logInUser(info.profileObj, res.data.token)))\n      .catch(err => console.error(err));\n  }\n\n  return (\n    <>\n      <GoogleLogout\n        className={loggedIn ? '' : 'hidden'}\n        clientId={appId}\n        buttonText=\"Logout\"\n        onLogoutSuccess={() => dispatch(logOutUser())}\n      ></GoogleLogout>\n      <GoogleLogin\n        clientId={appId}\n        className={loggedIn ? 'hidden' : ''}\n        buttonText=\"Log In With Google\"\n        onSuccess={res => handleLogin(res)}\n        onFailure={res => console.error(`Login Error: ${res}`)}\n        cookiePolicy={'single_host_origin'}\n      />\n    </>\n  );\n}\n","export function checkToken() {\n  return { type: 'CHECK_TOKEN' };\n}\nexport function setSocket(socket) {\n  return { type: 'SET_SOCKET', payload: socket };\n}\nexport function setUserInfo(userInfo) {\n  return { type: 'SET_USER_INFO', payload: userInfo };\n}\nexport function logInUser(userInfo, token) {\n  return { type: 'LOG_IN', payload: { token, userInfo } };\n}\nexport function logOutUser() {\n  return { type: 'LOG_OUT', payload: false };\n}\nexport function setGameId(id) {\n  return { type: 'SET_GAME_ID', payload: id };\n}\nexport function setCountdown(count) {\n  return { type: 'SET_COUNTDOWN', payload: count };\n}\nexport function setWords(words) {\n  return { type: 'SET_WORDS', payload: words };\n}\nexport function resetWords() {\n  return { type: 'RESET_WORDS' };\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport GoogleLoginButton from './loginButton';\n\nfunction NavBar(props) {\n  return (\n    <header className=\"header\">\n      <div className=\"home-menu pure-menu pure-menu-horizontal pure-menu-fixed\">\n        <a className=\"pure-menu-heading\" href=\"/\">\n          Converge\n        </a>\n        <ul className=\"pure-menu-list\">\n          {props.userInfo && (\n            <li className=\"pure-menu-item\">\n              <img\n                className=\"user-image\"\n                src={props.userInfo.imageUrl}\n                alt={props.userInfo.name}\n              />\n            </li>\n          )}\n          <li className=\"pure-menu-item\">\n            <GoogleLoginButton></GoogleLoginButton>\n          </li>\n        </ul>\n      </div>\n    </header>\n  );\n}\n\nexport default connect(store => store)(NavBar);\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { Redirect } from 'react-router-dom';\n\nexport default function CountdownPage() {\n  const count = useSelector(s => s.countdown);\n\n  return count > 0 ? (\n    <div>\n      <h1>COUNTDOWN</h1>\n      <h2>Game starts in: {count}</h2>\n    </div>\n  ) : (\n    <Redirect to=\"/game\"></Redirect>\n  );\n}\n","import { useSelector } from 'react-redux';\n\nconst validMessages = ['joinGame', 'sendWord', 'startNewGame'];\n\nexport default function useEmitter(type) {\n  const socket = useSelector(s => s.socket);\n  if (socket) {\n    if (validMessages.includes(type)) {\n      return data => {\n        socket.emit(type, data);\n      };\n    }\n    throw new Error(`Invalid socket message type: ${type}`);\n  }\n}\n","import React, { useState, useEffect } from 'react';\nimport useEmitter from '../../hooks/useEmitter';\nimport { useSelector } from 'react-redux';\n\nexport default function GamePage() {\n  const [word, setWord] = useState('');\n  const [submitted, setSubmitted] = useState(false);\n\n  const emitSendWord = useEmitter('sendWord');\n  const words = useSelector(s => s.words);\n  const socket = useSelector(s => s.socket);\n\n  useEffect(() => {\n    console.log(words);\n    setSubmitted(false);\n    setWord('');\n  }, [words]);\n\n  function onChangeWord(e) {\n    setWord(e.target.value);\n  }\n\n  function onSubmitWord() {\n    emitSendWord(word);\n    setSubmitted(true);\n  }\n\n  const roundWords = words ? words[words.length - 1] : {};\n  const myId = socket.id;\n  const theirId = words\n    ? Object.keys(roundWords).filter(e => e !== myId)[0]\n    : null;\n\n  return (\n    <div>\n      <h1>GAME ON</h1>\n      {words && words.length > 0 ? (\n        <div>\n          <div>Your Last Word: {roundWords[myId]}</div>\n          <div>\n            Their Last Word:\n            {roundWords[theirId]}\n          </div>\n        </div>\n      ) : (\n        ''\n      )}\n      {submitted ? (\n        <div>You sent: {word} -- waiting...</div>\n      ) : (\n        <div>\n          Enter a word: <input value={word} onChange={onChangeWord}></input>\n          <button onClick={onSubmitWord}>GO!</button>\n        </div>\n      )}\n    </div>\n  );\n}\n","import React from 'react';\nimport { useState } from 'react';\nimport useEmitter from '../../hooks/useEmitter';\nimport { useSelector } from 'react-redux';\nimport { Redirect } from 'react-router-dom';\n\nexport default function JoinGamePage() {\n  const [gameId, setGameId] = useState('');\n  const emitJoinGame = useEmitter('joinGame');\n  const countdown = useSelector(s => s.countdown);\n\n  function onBeginGame() {\n    emitJoinGame(gameId);\n  }\n  function onGameIdChange(e) {\n    setGameId(e.target.value);\n  }\n\n  return countdown ? (\n    <Redirect to=\"/cd\"></Redirect>\n  ) : (\n    <div>\n      <h1>JOIN GAME</h1>\n      Game ID: <input value={gameId} onChange={onGameIdChange}></input>\n      <button onClick={onBeginGame}>Begin!</button>\n    </div>\n  );\n}\n","import React from 'react';\nimport { useSelector } from 'react-redux';\nimport { Redirect } from 'react-router-dom';\n\nexport default function LoginPage() {\n  const loggedIn = useSelector(s => s.loggedIn);\n\n  return loggedIn ? (\n    <Redirect to=\"/\" />\n  ) : (\n    <div>\n      <h1>LOG IN -----> over there</h1>\n    </div>\n  );\n}\n","import React from 'react';\n\nexport default function UserInfo(props) {\n  const info = props.userInfo;\n\n  return (\n    <div>\n      <h1>Hi, {info.givenName}!</h1>\n      {/* <img src={info.imageUrl} alt={info.name} /> */}\n    </div>\n  );\n}\n","import React from 'react';\nimport UserInfo from '../userInfo';\nimport { useSelector } from 'react-redux';\n\nexport default function UserPage() {\n  const userInfo = useSelector(s => s.userInfo);\n  return <UserInfo userInfo={userInfo}></UserInfo>;\n}\n","import React from 'react';\nimport UserPage from './userPage';\nimport { Link } from 'react-router-dom';\n\nexport default function MainPage() {\n  // TBD: dispatch RESET_GAME\n  return (\n    <div>\n      <UserPage></UserPage>\n      <Link to=\"/new\">Start a New Game</Link>\n      or\n      <Link to=\"/join\">Join a Game</Link>\n    </div>\n  );\n}\n","import React from 'react';\nimport useEmitter from '../../hooks/useEmitter';\nimport { useSelector } from 'react-redux';\nimport { useEffect } from 'react';\nimport { Redirect } from 'react-router-dom';\n\nexport default function StartGamePage() {\n  const emitStartGame = useEmitter('startNewGame');\n  const gameId = useSelector(s => s.gameId);\n  const countdown = useSelector(s => s.countdown);\n\n  useEffect(() => emitStartGame(), []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  return countdown ? (\n    <Redirect to=\"/cd\"></Redirect>\n  ) : gameId ? (\n    <div>\n      Your game id is:<h1>{gameId}</h1>\n    </div>\n  ) : (\n    <h1>Starting...</h1>\n  );\n}\n","import React, { useEffect } from 'react';\nimport './App.scss';\nimport io from 'socket.io-client';\nimport { checkToken } from './actions';\nimport { useSelector, useDispatch } from 'react-redux';\nimport useSocketSetup from './hooks/useSocketSetup';\nimport {\n  BrowserRouter as Router,\n  Route,\n  Switch,\n  Redirect,\n} from 'react-router-dom';\n\nimport NavBar from './components/navBar';\nimport CountdownPage from './components/pages/countdownPage';\nimport GamePage from './components/pages/gamePage';\nimport JoinGamePage from './components/pages/joinGamePage';\nimport LoginPage from './components/pages/loginPage';\nimport MainPage from './components/pages/mainPage';\nimport NewGamePage from './components/pages/startGamePage';\n\nexport default function App() {\n  const endpoint = useSelector(s => s.endpoint);\n  const dispatch = useDispatch();\n  const token = useSelector(s => s.token);\n  const initSocket = useSocketSetup();\n\n  useEffect(() => {\n    dispatch(checkToken());\n    if (token) {\n      const socket = io.connect(endpoint, {\n        query: `token=${token}`, // why no Bearer work?  ¯\\_(ツ)_/¯\n      });\n\n      socket\n        .on('connect', () => {\n          initSocket(socket);\n        })\n        .on('unauthorized', msg => {\n          console.log(`unauthorized: ${JSON.stringify(msg.data)}`);\n          throw new Error(msg.data.type);\n        });\n    }\n  }, [token]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  return (\n    <Router>\n      <NavBar></NavBar>\n      <div className=\"content\">\n        <Switch>\n          <Route exact path=\"/login\">\n            <LoginPage></LoginPage>\n          </Route>\n          <AuthRoute exact path=\"/\">\n            <MainPage></MainPage>\n          </AuthRoute>\n          <AuthRoute exact path=\"/new\">\n            <NewGamePage></NewGamePage>\n          </AuthRoute>\n          <AuthRoute exact path=\"/join\">\n            <JoinGamePage></JoinGamePage>\n          </AuthRoute>\n          <AuthRoute exact path=\"/cd\">\n            <CountdownPage></CountdownPage>\n          </AuthRoute>\n          <AuthRoute exact path=\"/game\">\n            <GamePage></GamePage>\n          </AuthRoute>\n        </Switch>\n      </div>\n    </Router>\n  );\n}\n\nfunction AuthRoute({ children, ...rest }) {\n  const loggedIn = !!useSelector(s => s.userInfo);\n\n  return (\n    <Route\n      {...rest}\n      render={({ location }) =>\n        loggedIn ? (\n          children\n        ) : (\n          <Redirect\n            to={{\n              pathname: '/login',\n              state: { from: location },\n            }}\n          />\n        )\n      }\n    />\n  );\n}\n","import { createStore } from 'redux';\n// NB: I am committing a sin by setting the token in localStorage in my reducers.\n\nconst tokenKey = '_t';\nconst defaultStore = {\n  appId:\n    '730966416306-dv0e9pb4m0k6khl2nrn5r9vskv2j8hmk.apps.googleusercontent.com',\n  countdown: undefined,\n  endpoint:\n    process.env.NODE_ENV === 'production'\n      ? 'https://converge-game-be.herokuapp.com'\n      : 'http://localhost:8000',\n  gameId: undefined,\n  loggedIn: false,\n  socket: undefined,\n  token: undefined,\n  userInfo: undefined,\n  words: undefined,\n};\n\nfunction reducer(state = defaultStore, action) {\n  switch (action.type) {\n    case 'CHECK_TOKEN':\n      const localToken = localStorage.getItem(tokenKey);\n      return { ...state, token: localToken };\n    case 'SET_USER_INFO':\n      return { ...state, userInfo: action.payload, loggedIn: true };\n    case 'SET_SOCKET':\n      return { ...state, socket: action.payload };\n    case 'LOG_IN':\n      const { token, userInfo } = action.payload;\n      localStorage.setItem(tokenKey, token);\n      return { ...state, userInfo, token, loggedIn: true };\n    case 'LOG_OUT':\n      localStorage.setItem(tokenKey, '');\n      state.socket.disconnect(true);\n      return {\n        ...state,\n        loggedIn: false,\n        token: undefined,\n        userInfo: undefined,\n      };\n    case 'SET_GAME_ID':\n      return { ...state, gameId: action.payload };\n    case 'SET_COUNTDOWN':\n      return { ...state, countdown: action.payload };\n    case 'RESET_COUNTDOWN':\n      return { ...state, countdown: undefined };\n    case 'SET_WORDS':\n      return { ...state, words: action.payload };\n    case 'RESET_WORDS':\n      return { ...state, words: undefined };\n    default:\n      return state;\n  }\n}\n\nexport const store = createStore(reducer, defaultStore);\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { Provider } from 'react-redux';\nimport { store } from './redux-store';\n\nReactDOM.render(\n  <Provider store={store}>\n    <App className=\"app\" />\n  </Provider>,\n  document.getElementById('root')\n);\n\nconsole.log(`ENV: ${process.env.NODE_ENV}`)","import { setSocket } from '../actions';\nimport { useDispatch } from 'react-redux';\nimport { setGameId, setCountdown, setWords } from '../actions';\n\nexport default function useSocketSetup() {\n  const dispatch = useDispatch();\n  return socket => {\n    socket.on('info', message => console.info(`INFO: ${message}`));\n    socket.on('newGameCreated', data => dispatch(setGameId(data.gameId)));\n    socket.on('startCountdown', count => dispatch(setCountdown(count)));\n    socket.on('startGame', msg => console.log(msg));\n    socket.on('roundOver', words => dispatch(setWords(words)));\n    socket.on('winGame', null);\n    dispatch(setSocket(socket));\n  };\n}\n"],"sourceRoot":""}